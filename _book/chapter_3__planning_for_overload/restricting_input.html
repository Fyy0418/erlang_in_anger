<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Restricting Input | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.3">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../chapter_3__planning_for_overload/how_long_should_a_time_out_be.html" />
    
    
    <link rel="prev" href="../chapter_3__planning_for_overload/unexpected_messages.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="3.2" data-basepath=".." data-revision="1414082137407">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="chapter_1/README.html">
            
                
                    <a href="../chapter_1/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Chapter 1 How to Dive into a Code Base
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="chapter_1/11_raw_erlang.html">
            
                
                    <a href="../chapter_1/11_raw_erlang.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Raw Erlang
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="chapter_1/otp_applications.html">
            
                
                    <a href="../chapter_1/otp_applications.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         OTP Applications
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.2.1" data-path="chapter_1/library_applications.html">
            
                
                    <a href="../chapter_1/library_applications.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.1.</b>
                        
                         Library Applications
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2.2" data-path="chapter_1/regular_applications.html">
            
                
                    <a href="../chapter_1/regular_applications.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.2.</b>
                        
                         Regular Applications
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2.3" data-path="chapter_1/dependencies.html">
            
                
                    <a href="../chapter_1/dependencies.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.3.</b>
                        
                         Dependencies
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="chapter_1/otp_realease.html">
            
                
                    <a href="../chapter_1/otp_realease.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         OTP Releases
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="chapter_1/excerises.html">
            
                
                    <a href="../chapter_1/excerises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         Excerises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="chapter_2_building_open_source_erlang_software/README.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Chapter 2 Building Open Source Erlang Software
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="chapter_2_building_open_source_erlang_software/project_structure.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/project_structure.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         Project Structure
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1.1" data-path="chapter_2_building_open_source_erlang_software/otp_applications.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/otp_applications.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                         OTP Applications
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.2" data-path="chapter_2_building_open_source_erlang_software/otp_releases.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/otp_releases.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                         OTP Releases
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="chapter_2_building_open_source_erlang_software/supervisors_and_start_link_semantics.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/supervisors_and_start_link_semantics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Supervisors and start_link Semantics
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.2.1" data-path="chapter_2_building_open_source_erlang_software/its_about_the_guarantees.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/its_about_the_guarantees.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                          It’s About the Guarantees
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.2" data-path="chapter_2_building_open_source_erlang_software/side_effects.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/side_effects.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.2.</b>
                        
                         Side Effects
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.3" data-path="chapter_2_building_open_source_erlang_software/example_initializing_without_guaranteeing_connections.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/example_initializing_without_guaranteeing_connections.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.3.</b>
                        
                          Example: Initializing without guaranteeing connections
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.4" data-path="chapter_2_building_open_source_erlang_software/in_a_nutshell.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/in_a_nutshell.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.4.</b>
                        
                         In a nutshell
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.5" data-path="chapter_2_building_open_source_erlang_software/application_strategies.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/application_strategies.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.5.</b>
                        
                         Application Strategies
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="chapter_2_building_open_source_erlang_software/exercises.html">
            
                
                    <a href="../chapter_2_building_open_source_erlang_software/exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         Exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="chapter_3__planning_for_overload/README.html">
            
                
                    <a href="../chapter_3__planning_for_overload/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Chapter 3  Planning for Overload
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="chapter_3__planning_for_overload/common_overload_sources.html">
            
                
                    <a href="../chapter_3__planning_for_overload/common_overload_sources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         Common Overload Sources
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1.1" data-path="chapter_3__planning_for_overload/error_logger_explodes.html">
            
                
                    <a href="../chapter_3__planning_for_overload/error_logger_explodes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                         error_logger Explodes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.1.2" data-path="chapter_3__planning_for_overload/locks_and_blocking_operations.html">
            
                
                    <a href="../chapter_3__planning_for_overload/locks_and_blocking_operations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                         Locks and Blocking Operations
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.1.3" data-path="chapter_3__planning_for_overload/unexpected_messages.html">
            
                
                    <a href="../chapter_3__planning_for_overload/unexpected_messages.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.3.</b>
                        
                         Unexpected Messages
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter active" data-level="3.2" data-path="chapter_3__planning_for_overload/restricting_input.html">
            
                
                    <a href="../chapter_3__planning_for_overload/restricting_input.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         Restricting Input
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.2.1" data-path="chapter_3__planning_for_overload/how_long_should_a_time_out_be.html">
            
                
                    <a href="../chapter_3__planning_for_overload/how_long_should_a_time_out_be.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.1.</b>
                        
                         How Long Should a Time Out Be
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2.2" data-path="chapter_3__planning_for_overload/asking_for_permission.html">
            
                
                    <a href="../chapter_3__planning_for_overload/asking_for_permission.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.2.</b>
                        
                         Asking For Permission
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2.3" data-path="chapter_3__planning_for_overload/what_users_see.html">
            
                
                    <a href="../chapter_3__planning_for_overload/what_users_see.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.3.</b>
                        
                         What Users See
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.3" data-path="chapter_3__planning_for_overload/discarding_data.html">
            
                
                    <a href="../chapter_3__planning_for_overload/discarding_data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                         Discarding Data
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.3.1" data-path="chapter_3__planning_for_overload/random_drop.html">
            
                
                    <a href="../chapter_3__planning_for_overload/random_drop.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.1.</b>
                        
                         Random Drop
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.2" data-path="chapter_3__planning_for_overload/queue_buffers.html">
            
                
                    <a href="../chapter_3__planning_for_overload/queue_buffers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.2.</b>
                        
                         Queue Buffers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.3" data-path="chapter_3__planning_for_overload/stack_buffers.html">
            
                
                    <a href="../chapter_3__planning_for_overload/stack_buffers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.3.</b>
                        
                         Stack Buffers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.4" data-path="chapter_3__planning_for_overload/time-sensitive_buffers.html">
            
                
                    <a href="../chapter_3__planning_for_overload/time-sensitive_buffers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.4.</b>
                        
                         Time-Sensitive Buffers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.5" data-path="chapter_3__planning_for_overload/dealing_with_constant_overload.html">
            
                
                    <a href="../chapter_3__planning_for_overload/dealing_with_constant_overload.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.5.</b>
                        
                         Dealing With Constant Overload
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.6" data-path="chapter_3__planning_for_overload/how_do_you_drop.html">
            
                
                    <a href="../chapter_3__planning_for_overload/how_do_you_drop.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.6.</b>
                        
                         How Do You Drop
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.4" data-path="chapter_3__planning_for_overload/exercises.html">
            
                
                    <a href="../chapter_3__planning_for_overload/exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                         Exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="chapter_4_connecting_to_remote_nodes/README.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Chapter 4 Connecting to Remote Nodes
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="chapter_4_connecting_to_remote_nodes/job_control_mode.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/job_control_mode.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Job Control Mode
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="chapter_4_connecting_to_remote_nodes/remsh.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/remsh.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Remsh
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="chapter_4_connecting_to_remote_nodes/ssh_daemon.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/ssh_daemon.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         SSH Daemon
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="chapter_4_connecting_to_remote_nodes/named_pipes.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/named_pipes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         Named Pipes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.5" data-path="chapter_4_connecting_to_remote_nodes/exercises.html">
            
                
                    <a href="../chapter_4_connecting_to_remote_nodes/exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_43584">
                    
                        <h1 id="restricting-input">Restricting Input</h1>
<h1 id="">限制输入</h1>
<p>Restricting input is the simplest way to manage message queue growth in Erlang systems.<br>
It’s the simplest approach because it basically means you’re slowing the user down (applying back-pressure), which instantly fixes the problem without any further optimization required.<br>
On the other hand, it can lead to a really crappy experience for the user.</p>
<p></p> <font color="green">
限制输入是处理Erlang系统日益增长的消息队列中最简单的方法。<br>
之所以简单，是因为这意味着减慢了用户(相对于满负荷:back-pressure工作来说)，这可以马上修复问题且不要求做更多的优化。<br>
但另一方面，这会给用户一个非常糟糕的体验。
</font> <p></p>
The most common way to restrict data input is to make calls to a process whose queue would grow in uncontrollable ways synchronously. By requiring a response before moving on to the next request, you will generally ensure that the direct source of the problem will be slowed down.
<p></p> <font color="green">
最常用的限制输入的方法就是使无法控制自己消息队列增长的进程变成同步处理。在处理下一个请求(request)之前需要前一个请求的回应(response),这样同步处理肯定会使效率慢下来。
</font> <p></p>
The difficult part for this approach is that the bottleneck causing the queue to grow is usually not at the edge of the system, but deep inside it, which you find after optimizing nearly everything that came before. Such bottlenecks will often be database operations, disk operations, or some service over the network.
<p></p> <font color="green">
这个方法的难度在于造成消息队列增长的短板通常不是系统边缘(the edge of the system)导致的，当你深入理解后，你就会发现要去优化系统的每个细节。这个瓶颈通常来自于数据库操作，硬盘读写，或其它要借住网络的服务。
</font> <p></p>
This means that when you introduce synchronous behaviour deep in the system, you’ll possibly need to handle back-pressure, level by level, until you end up at the system’s edges and can tell the user, &quot;please slow down.&quot;
<p></p> <font color="green">
这就意味当你介绍系统的深度同步的行为时，你可能从系统内部到边缘一层层地限制负荷，并还要忠告用户：”请悠着点用“。
</font> <p></p>
Developers that see this pattern will often try to put API limits per user <sup>8</sup> on the system entry points. This is a valid approach, especially since it can guarantee a basic quality of service (QoS) to the system and allows one to allocate resources as fairly (or unfairly) as desired.
<p></p> <font color="green">
开发者看到这种模式会经常试图在系统的入口的API给每个用户都做限制<sup>8</sup>。 这的确是一个有效的方法，特别是可以保证一个最基本的服务质量(base quality of service,QoS)。可以允许用户自由地分配资源。
</font> <p></p>
[8] There’s a tradeoff between slowing down all requests equally or using rate-limiting, both of which are valid. Rate-limiting per user would mean you’d still need to increase capacity or lower the limits of all users when more new users hammer your system, whereas a synchronous system that indiscriminately blocks
should adapt to any load with more ease, but possibly unfairly.<br>
<p></p> <font color="red">
[注8]：
</font> <p></p>


                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../chapter_3__planning_for_overload/unexpected_messages.html" class="navigation navigation-prev " aria-label="Previous page: Unexpected Messages"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../chapter_3__planning_for_overload/how_long_should_a_time_out_be.html" class="navigation navigation-next " aria-label="Next page: How Long Should a Time Out Be"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
